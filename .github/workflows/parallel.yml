name: Cypress Tests parallel

on: push

jobs:
  install:
    runs-on: ubuntu-22.04
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Cypress install
        uses: cypress-io/github-action@v6
        with:
          # Disable running of tests within install job
          runTests: false

  cypress-run:
            runs-on: ubuntu-22.04
            needs: install
            strategy:
              # don't fail the entire matrix on failure
              fail-fast: false
              matrix:
                # run copies of the current job in parallel
                containers: [1, 2, 3, 4, 5]
            steps:
              - name: Checkout
                uses: actions/checkout@v4
        
              - name: run tests
                uses: cypress-io/github-action@v6
                with:
                  record: true
                  parallel: true
                  group: 'UI-Chrome'
                  start: npm run prod:runcloud
        
              